<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>GALAXY OF KNOWLEDGE</title><style>@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');body{margin:0;padding:0;background:#000;color:#fff;font-family:'Press Start 2P',cursive;overflow:hidden;touch-action:manipulation;image-rendering:pixelated;transition:background-color .3s}#gameCanvas{position:fixed;top:0;left:0;width:100vw;height:100vh;display:block;z-index:1;background:#000;image-rendering:pixelated}#settingsWheel{position:fixed;top:10px;right:10px;font-size:24px;cursor:pointer;z-index:20;transition:transform .3s;display:none}#settingsWheel:hover{transform:rotate(30deg)}#menuScreen,#gameOverScreen,#highscoreScreen,#settingsScreen,#winScreen,#tutorialScreen,#waveScreen,#quizScreen,#objectivesScreen{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;background:rgba(0,0,0,.9);z-index:10}#triviaContainer{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);width:90%;max-width:800px;z-index:3;background:rgba(0,0,20,.7);padding:15px;display:none;box-sizing:border-box;text-align:center;border:2px solid #FD0;border-radius:5px}#triviaQuestion{font-size:16px;margin-bottom:15px;color:#FD0;text-shadow:2px 2px 0 #630;line-height:1.4;padding:12px}#triviaOptions{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;position:relative}.triviaOption{padding:15px;margin:0;background:rgba(0,0,40,.8);text-align:center;flex:1;min-width:150px;font-size:14px;transition:all .1s;cursor:pointer;font-family:'Press Start 2P',cursive;text-shadow:1px 1px 0 #000;color:#fff;border:2px solid #555;min-height:60px;display:flex;align-items:center;justify-content:center;position:relative}.triviaOption.highlighted{background:rgba(85,85,255,.7);box-shadow:0 0 10px rgba(255,215,0,.7);border-color:#FD0}.triviaOption.highlighted::after{content:'(Z)';position:absolute;top:-10px;right:-10px;background:#FD0;color:#000;font-size:12px;padding:2px 5px;border-radius:0;border:2px solid #630}.triviaOption.selected{background:#2E7D32;border-color:#4CAF50}.triviaOption.incorrect{background:#B71C1C;border-color:#F44336}.answer-feedback{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:24px;color:#fff;text-shadow:3px 3px 0 #000;z-index:4;background:rgba(0,0,0,.7);padding:20px;border-radius:5px;display:none}.correct-feedback{color:#4CAF50;border:2px solid #4CAF50}.incorrect-feedback{color:#F44336;border:2px solid #F44336}.title{font-size:32px;font-weight:400;margin-bottom:30px;color:#FD0;text-align:center;text-shadow:4px 4px 0 #630;line-height:1.3}.menu-button{width:200px;height:50px;margin:10px;font-size:16px;cursor:pointer;border:none;border-radius:0;background:#333;color:#fff;box-shadow:4px 4px 0 #555;transition:all .1s;font-family:'Press Start 2P',cursive;text-shadow:2px 2px 0 #000}.menu-button:hover{transform:translateY(-2px);box-shadow:6px 6px 0 #555}.menu-button:active{transform:translateY(2px);box-shadow:2px 2px 0 #555}#playButton{background:#2E7D32;box-shadow:4px 4px 0 #4CAF50}#highscoreButton{background:#FF8F00;box-shadow:4px 4px 0 #FFC107;color:#000}#settingsButton{background:#0D47A1;box-shadow:4px 4px 0 #2196F3}#tutorialButton{background:#6A1B9A;box-shadow:4px 4px 0 #9C27B0}#hud{position:absolute;top:10px;left:10px;font-size:14px;background:rgba(0,0,0,.9);padding:8px 12px;border-radius:0;border:2px solid #FD0;display:none;z-index:2;font-family:'Press Start 2P',cursive;text-shadow:2px 2px 0 #000;box-shadow:0 0 10px rgba(255,215,0,.5)}#durabilityHud{position:absolute;bottom:10px;left:10px;font-size:12px;color:#fff;background:rgba(0,0,0,.9);padding:8px 12px;border-radius:0;border:2px solid #FD0;display:none;z-index:2;font-family:'Press Start 2P',cursive;text-shadow:2px 2px 0 #000;box-shadow:0 0 10px rgba(255,215,0,.5)}.durability-ships{display:flex;flex-direction:column;gap:5px}.durability-title{font-size:12px;margin-bottom:5px;text-decoration:underline;color:#FD0}.ship-durability-row{display:flex;align-items:center;gap:10px}.ship-key{width:20px;text-align:center;background:#333;padding:2px;border:1px solid #555}.ship-icon-small{width:20px;height:20px;border-radius:0}.ship-icon-small.default{background-color:#4CAF50}.ship-icon-small.bangka{background-color:#630}.ship-icon-small.jeepney{background-color:#FD0}.durability-icons{display:flex;gap:3px}.durability-icon{width:16px;height:16px;border:1px solid #555}.durability-icon.default{background-color:#4CAF50}.durability-icon.bangka{background-color:#630}.durability-icon.jeepney{background-color:#FD0}#powerupHud{position:fixed;top:10px;right:50px;font-size:12px;text-align:right;background:rgba(0,0,0,.9);padding:8px 12px;border-radius:0;border:2px solid #FD0;display:none;z-index:2;font-family:'Press Start 2P',cursive;text-shadow:2px 2px 0 #000;box-shadow:0 0 10px rgba(255,215,0,.5)}#bossHealthBar{position:fixed;top:10px;left:50%;transform:translateX(-50%);width:300px;height:16px;background:#F44336;border-radius:0;overflow:hidden;border:2px solid #FD0;display:none;z-index:2;box-shadow:0 0 10px rgba(255,215,0,.5)}#bossHealth{height:100%;background:#4CAF50;width:100%;transition:width .1s}#shipSelection{position:fixed;bottom:120px;left:20px;display:flex;flex-direction:column;gap:8px;display:none;z-index:2}.ship-icon{width:32px;height:32px;border:2px solid #555;border-radius:0;display:flex;justify-content:center;align-items:center;font-weight:400;background:rgba(0,0,0,.7);color:#fff;font-size:14px;transition:all .1s;font-family:'Press Start 2P',cursive;cursor:pointer}.ship-icon.available{border-color:#FD0;box-shadow:0 0 10px rgba(255,215,0,.7);animation:pulse 1s infinite;background:rgba(255,215,0,.2)}@keyframes pulse{0%{box-shadow:0 0 2px rgba(255,215,0,.7)}50%{box-shadow:0 0 10px rgba(255,215,0,.9)}100%{box-shadow:0 0 2px rgba(255,215,0,.7)}}#mobileControls{position:fixed;bottom:20px;width:100%;display:none;justify-content:center;z-index:2}.mobile-btn{width:60px;height:60px;margin:0 15px;background:rgba(255,255,255,.2);border-radius:0;display:flex;justify-content:center;align-items:center;font-size:20px;user-select:none;color:#fff;border:2px solid rgba(255,255,255,.3);box-shadow:4px 4px 0 rgba(0,0,0,.3);transition:all .1s}.mobile-btn:active{transform:translateY(2px);box-shadow:2px 2px 0 rgba(0,0,0,.3);background:rgba(255,255,255,.3)}.settings-row{display:flex;align-items:center;margin:15px 0;width:80%;max-width:400px;justify-content:space-between;font-size:12px}.settings-button{width:32px;height:32px;border-radius:0;border:none;background:#333;color:#fff;font-size:16px;cursor:pointer;margin:0 8px;box-shadow:3px 3px 0 #555;font-family:'Press Start 2P',cursive}.settings-value{min-width:50px;text-align:center;font-size:12px}#timerContainer{position:fixed;bottom:100px;left:50%;transform:translateX(-50%);width:200px;height:20px;background:rgba(0,0,0,.7);border:2px solid #FD0;display:none;z-index:2}#timerBar{height:100%;background:#FD0;width:100%;transition:width .1s}#waveTransitionMessage{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:24px;color:#FD0;text-shadow:3px 3px 0 #630;display:none;z-index:2;font-family:'Press Start 2P',cursive;text-align:center;background:rgba(0,0,0,.7);padding:20px;border:2px solid #FD0}#triviaLaserHud{position:fixed;bottom:10px;right:10px;font-size:12px;color:#fff;background:rgba(0,0,0,.9);padding:8px 12px;border-radius:0;border:2px solid #FD0;display:none;z-index:2;font-family:'Press Start 2P',cursive;text-shadow:2px 2px 0 #000;box-shadow:0 0 10px rgba(255,215,0,.5)}#triviaLaserBar{width:100px;height:10px;background:#333;margin-top:5px;border:1px solid #555}#triviaLaserFill{height:100%;width:0%;background:#4CAF50;transition:width .1s}#waveTransitionTimer{position:fixed;top:20px;left:50%;transform:translateX(-50%);font-size:24px;color:#FD0;text-shadow:3px 3px 0 #630;display:none;z-index:2;font-family:'Press Start 2P',cursive}#objectivesScreen{display:none}.objectives-content{max-width:800px;max-height:80vh;overflow-y:auto;padding:20px;background:rgba(0,0,0,.7);border:2px solid #FD0;margin-bottom:20px}.objective-item{margin-bottom:15px;font-size:14px;line-height:1.5}.objective-item::before{content:"• ";color:#FD0}.ship-icon .cooldown{position:absolute;bottom:0;left:0;width:100%;height:0%;background:rgba(0,0,0,.7);transition:height .1s}.special-key{position:fixed;bottom:80px;right:20px;width:32px;height:32px;border:2px solid #FD0;border-radius:0;display:flex;justify-content:center;align-items:center;font-weight:400;background:rgba(0,0,0,.7);color:#fff;font-size:14px;transition:all .1s;font-family:'Press Start 2P',cursive;z-index:2;display:none;box-shadow:0 0 10px rgba(255,215,0,.5)}.special-key.available{border-color:#FD0;box-shadow:0 0 10px rgba(255,215,0,.7);animation:pulse 1s infinite;background:rgba(255,215,0,.2)}.special-key .cooldown{position:absolute;bottom:0;left:0;width:100%;height:0%;background:rgba(0,0,0,.7);transition:height .1s}.laser-beam{position:absolute;left:0;top:0;width:100%;height:100%;background:linear-gradient(to bottom,rgba(0,255,255,.8) 0%,rgba(0,255,255,.2) 100%);z-index:3;pointer-events:none;opacity:0;transition:opacity .3s}#pauseOverlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);z-index:15;display:none;justify-content:center;align-items:center;font-size:48px;color:#FD0;text-shadow:4px 4px 0 #630}@media (max-width:768px){#mobileControls{display:flex}.title{font-size:24px;text-shadow:3px 3px 0 #630}.menu-button{width:160px;height:40px;font-size:14px}#triviaOptions{flex-direction:column}.triviaOption{min-width:80%;margin:5px auto;font-size:12px;padding:10px}#triviaQuestion{font-size:14px}#hud,#powerupHud,#durabilityHud{font-size:10px;padding:5px 8px}.mobile-btn{width:50px;height:50px;margin:0 10px;font-size:18px}.tutorial-content{max-width:90%;font-size:10px}.tutorial-title{font-size:14px}.tutorial-text{font-size:10px}#nameInput,#nameInputWin{width:120px;font-size:12px}.wave-title{font-size:32px}.quiz-title{font-size:18px}.quiz-question{font-size:14px}.quiz-options{width:90%}#waveTransitionMessage{font-size:18px;width:90%}#waveTransitionTimer{font-size:18px;top:10px}.objectives-content{font-size:12px}}</style></head><body><div id="settingsWheel">⚙️</div><div id="gameOverCover"></div><div class="laser-beam" id="laserBeam"></div><div id="pauseOverlay">PAUSED</div><canvas id="gameCanvas"></canvas><div class="answer-feedback correct-feedback" id="correctFeedback">CORRECT!</div><div class="answer-feedback incorrect-feedback" id="incorrectFeedback">WRONG!</div><div id="hud"><div>SCORE: <span id="scoreDisplay">0</span></div><div>COMBO: <span id="comboCount">0x</span></div></div><div id="durabilityHud"><div class="durability-ships"><div class="durability-title">DURABILITY:</div><div class="ship-durability-row"><span>DEFAULT: </span><span class="ship-key">X</span><div class="durability-icons" id="defaultDurabilityIcons"></div></div><div class="ship-durability-row"><span>BANGKA: </span><span class="ship-key">C</span><div class="durability-icons" id="bangkaDurabilityIcons"></div></div><div class="ship-durability-row"><span>JEEPNEY: </span><span class="ship-key">V</span><div class="durability-icons" id="jeepneyDurabilityIcons"></div></div></div></div><div id="powerupHud"><div>POWERUPS: <span id="powerupStatus">NONE</span></div></div><div id="triviaLaserHud"><div>TRIVIA LASER:</div><div id="triviaLaserBar"><div id="triviaLaserFill"></div></div></div><div id="bossHealthBar"><div id="bossHealth"></div></div><div id="timerContainer"><div id="timerBar"></div></div><div id="waveTransitionMessage"></div><div id="waveTransitionTimer"></div><div id="comboCounter"></div><div id="waveIndicator">WAVE: <span id="waveNumber">1</span></div><div id="triviaContainer"><div id="triviaQuestion"></div><div id="triviaOptions"></div></div><div id="shipSelection"><div class="ship-icon" id="defaultShip" title="Default Ship (X)">X</div><div class="ship-icon" id="bangkaShip" title="Bangka Ship (C)">C</div><div class="ship-icon" id="jeepneyShip" title="Jeepney Ship (V)">V</div></div><div class="special-key" id="specialKey">B</div><div id="mobileControls"><div class="mobile-btn" id="leftBtn">←</div><div class="mobile-btn" id="shootBtn">🔫</div><div class="mobile-btn" id="rightBtn">→</div><div class="mobile-btn" id="specialBtn">B</div></div><div id="menuScreen"><div class="title">GALAXY OF KNOWLEDGE</div><button id="playButton" class="menu-button">PLAY</button><button id="highscoreButton" class="menu-button">HIGHSCORE</button><button id="settingsButton" class="menu-button">SETTINGS</button><button id="tutorialButton" class="menu-button">TUTORIAL</button></div><div id="objectivesScreen" style="display:none"><div class="title">MISSION OBJECTIVES</div><div class="objectives-content"><div class="objective-item">DEFEAT ALL ENEMIES IN EACH WAVE</div><div class="objective-item">ANSWER TRIVIA QUESTIONS TO CHARGE LASER</div><div class="objective-item">DEFEAT THE FINAL BOSS AT WAVE 10</div><div class="objective-item">USE SPECIAL ABILITIES WITH [B] KEY</div><div class="objective-item">COLLECT POWER-UPS FOR SPECIAL ABILITIES</div><div class="objective-item">SWITCH SHIPS TO ADAPT TO SITUATIONS</div></div><button id="continueFromObjectives" class="menu-button" style="background:#2E7D32;box-shadow:4px 4px 0 #4CAF50">START GAME</button></div><div id="gameOverScreen" style="display:none"><div class="title">GAME OVER</div><div id="finalScore" style="font-size:20px;margin-bottom:20px"></div><div id="nameInputContainer"><div style="margin-bottom:10px;font-size:14px">ENTER YOUR NAME:</div><input type="text" id="nameInput" maxlength="10"><button id="submitScore" class="menu-button" style="background:#2E7D32;box-shadow:4px 4px 0 #4CAF50">SUBMIT</button></div><button id="continueButton" class="menu-button" style="background:#0D47A1;box-shadow:4px 4px 0 #2196F3">CONTINUE</button></div><div id="winScreen" style="display:none"><div class="title">YOU WIN!</div><div id="winScore" style="font-size:20px;margin-bottom:20px"></div><div id="nameInputContainerWin"><div style="margin-bottom:10px;font-size:14px">ENTER YOUR NAME:</div><input type="text" id="nameInputWin" maxlength="10"><button id="submitScoreWin" class="menu-button" style="background:#2E7D32;box-shadow:4px 4px 0 #4CAF50">SUBMIT</button></div><button id="winContinueButton" class="menu-button" style="background:#0D47A1;box-shadow:4px 4px 0 #2196F3">CONTINUE</button></div><div id="highscoreScreen" style="display:none"><div class="title">HIGH SCORES</div><div id="highscoreList" style="margin-bottom:30px;font-size:14px"></div><button id="backButton" class="menu-button" style="background:#0D47A1;box-shadow:4px 4px 0 #2196F3">BACK</button></div><div id="settingsScreen" style="display:none"><div class="title">SETTINGS</div><div class="settings-row"><div>MUSIC VOLUME:</div><button id="musicDown" class="settings-button">-</button><div id="musicVolume" class="settings-value">50%</div><button id="musicUp" class="settings-button">+</button></div><div class="settings-row"><div>SOUND EFFECTS:</div><button id="toggleSound" class="settings-button" style="width:60px">ON</button></div><div class="settings-row"><div>DIFFICULTY:</div><button id="changeDifficulty" class="settings-button" style="width:80px">NORMAL</button></div><button id="settingsBackButton" class="menu-button" style="background:#0D47A1;box-shadow:4px 4px 0 #2196F3;margin-top:30px">BACK TO GAME</button></div><div id="tutorialScreen" style="display:none"><div class="title">HOW TO PLAY</div><div class="tutorial-content"><div class="tutorial-section"><div class="tutorial-title">CONTROLS</div><div class="tutorial-row"><div class="tutorial-key">←</div><div class="tutorial-text">Move Left</div></div><div class="tutorial-row"><div class="tutorial-key">→</div><div class="tutorial-text">Move Right</div></div><div class="tutorial-row"><div class="tutorial-key">SPACE</div><div class="tutorial-text">Shoot Bullets</div></div><div class="tutorial-row"><div class="tutorial-key">X</div><div class="tutorial-text">Switch to Default Ship</div></div><div class="tutorial-row"><div class="tutorial-key">C</div><div class="tutorial-text">Switch to Bangka Ship</div></div><div class="tutorial-row"><div class="tutorial-key">V</div><div class="tutorial-text">Switch to Jeepney Ship</div></div><div class="tutorial-row"><div class="tutorial-key">Z</div><div class="tutorial-text">Select Answer (Boss Fight)</div></div><div class="tutorial-row"><div class="tutorial-key">B</div><div class="tutorial-text">Special Ability (All Ships)</div></div><div class="tutorial-row"><div class="tutorial-key">T</div><div class="tutorial-text">Fire Trivia Laser (When Charged)</div></div></div><div class="tutorial-section"><div class="tutorial-title">SHIPS</div><div class="tutorial-row"><div class="tutorial-ship tutorial-ship-default"></div><div class="tutorial-text">DEFAULT SHIP: Balanced stats</div></div><div class="tutorial-row"><div class="tutorial-ship tutorial-ship-bangka"></div><div class="tutorial-text">BANGKA SHIP: Strong but slow</div></div><div class="tutorial-row"><div class="tutorial-ship tutorial-ship-jeepney"></div><div class="tutorial-text">JEEPNEY SHIP: Fast but weak</div></div></div><div class="tutorial-section"><div class="tutorial-title">ENEMIES</div><div class="tutorial-row"><div class="tutorial-enemy tutorial-enemy-kapre"></div><div class="tutorial-text">KAPRE: Tough, slow-moving</div></div><div class="tutorial-row"><div class="tutorial-enemy tutorial-enemy-aswang"></div><div class="tutorial-text">ASWANG: Fast but fragile</div></div><div class="tutorial-row"><div class="tutorial-enemy tutorial-enemy-sarimanok"></div><div class="tutorial-text">SARIMANOK: Balanced enemy</div></div></div><div class="tutorial-section"><div class="tutorial-title">POWER-UPS</div><div class="tutorial-row"><div class="tutorial-powerup tutorial-powerup-shield"></div><div class="tutorial-text">SHIELD: Temporary protection</div></div><div class="tutorial-row"><div class="tutorial-powerup tutorial-powerup-boost"></div><div class="tutorial-text">BOOST: Increased speed</div></div><div class="tutorial-row"><div class="tutorial-powerup tutorial-powerup-tinikling"></div><div class="tutorial-text">TINIKLING: Faster shooting</div></div></div><div class="tutorial-section"><div class="tutorial-title">SPECIAL ABILITIES</div><div class="tutorial-row"><div class="tutorial-key">B</div><div class="tutorial-text">DEFAULT SHIP: Temporary shield</div></div><div class="tutorial-row"><div class="tutorial-key">B</div><div class="tutorial-text">BANGKA SHIP: Heal durability</div></div><div class="tutorial-row"><div class="tutorial-key">B</div><div class="tutorial-text">JEEPNEY SHIP: Speed boost</div></div></div></div><button id="tutorialBackButton" class="menu-button" style="background:#0D47A1;box-shadow:4px 4px 0 #2196F3;margin-top:20px">BACK TO MENU</button></div><div id="waveScreen" style="display:none"><div class="wave-title">WAVE <span id="waveDisplay">1</span></div><div id="waveSubtitle" style="font-size:18px;margin-bottom:30px;color:#fff">GET READY!</div><button id="startWaveButton" class="menu-button" style="background:#2E7D32;box-shadow:4px 4px 0 #4CAF50">START WAVE</button></div><div id="quizScreen" style="display:none"><div class="quiz-title">TRIVIA CHALLENGE</div><div class="quiz-question" id="quizQuestion"></div><div class="quiz-options" id="quizOptions"></div><div id="quizTimer" style="margin-top:20px;font-size:14px;color:#FD0"></div></div><script>const BOSS_WAVE=10,TRIVIA_LASER_MAX=100,STATE_MENU=0,STATE_PLAYING=1,STATE_GAME_OVER=2,STATE_HIGHSCORE=3,STATE_SETTINGS=4,STATE_WIN=5,STATE_TUTORIAL=6,STATE_WAVE=7,STATE_QUIZ=8,STATE_OBJECTIVES=9,c=document.getElementById('gameCanvas'),x=c.getContext('2d');let W=window.innerWidth,H=window.innerHeight;function r(){W=window.innerWidth,H=window.innerHeight,c.width=W,c.height=H,player&&(player.x=W/2-player.width/2,player.y=H-player.height-50),ba&&boss&&(boss.x=W/2-boss.width/2)}window.addEventListener('resize',r);let g=STATE_MENU,p={x:W/2-25,y:H-90,w:50,h:30,s:5,d:{a:3,b:3,j:3},sc:0,p:{bs:0,jb:0,tm:0},sk:'a',as:{a:1,b:0,j:0},tl:0,sa:{a:{c:0,m:300},b:{c:0,m:450},j:{c:0,m:240}}},b=[],e=[],eb=[],pw=[],bc=0,esr=60,est=0,ess=1,esh=0,cc=0,ct=0,w=1,eiw=0,ed=0,wdm=1,ba=0,bh=0,bmh=0,cq=0,so=0,asm=0,qst=0,qtl=15,qt=0,qca=0,tba=0,tbt=0,tbd=5,sma=0,smt=0,wt=0,wtd=600,wc=10,hs=[],mhs=10,s={mv:.5,se:1,d:'normal'},snd={s:new Audio('mixkit-game-whip-shot-1512.wav'),es:new Audio('mixkit-arrow-whoosh-1491.wav'),ex:new Audio('mixkit-arcade-game-explosion-1699.wav'),pu:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3'),co:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3'),w:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3'),bs:new Audio('mixkit-dinosaur-monster-roar-1976.wav'),sc:new Audio('mixkit-arcade-retro-jump-223 (1).wav'),wn:new Audio('mixkit-winning-chimes-2015.wav'),cb:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-extra-bonus-in-a-video-game-2045.mp3'),wc:new Audio('mixkit-arcade-bonus-alert-767.wav'),ht:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-arcade-retro-changing-tab-206.mp3'),ms:new Audio('mixkit-gear-fast-lock-tap-2857.wav'),mh:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-horror-ambience-228.mp3'),ls:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-laser-weapon-shot-1671.mp3'),sm:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-software-interface-start-2574.mp3'),hl:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-positive-interface-beep-221.mp3'),sh:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-magic-spell-shimmer-2367.mp3'),mo:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3'),gs:new Audio('https://assets.mixkit.co/sfx/preview/mixkit-game-show-suspense-waiting-668.mp3')},bgm=new Audio('https://assets.mixkit.co/music/preview/mixkit-game-level-music-689.mp3');bgm.volume=s.mv,bgm.loop=!0;const tq=[{q:"WHAT IS THE NATIONAL BIRD OF THE PHILIPPINES?",o:["MAYA","PHILIPPINE EAGLE","COCKATOO","KINGFISHER"],a:1,c:"NATIONAL SYMBOLS"},{q:"WHICH PHILIPPINE HERO IS KNOWN AS THE 'SUBLIME PARALYTIC'?",o:["JOSE RIZAL","ANDRES BONIFACIO","APOLINARIO MABINI","EMILIO AGUINALDO"],a:2,c:"HISTORY"},{q:"WHAT IS THE TRADITIONAL FILIPINO LEAF-WRAPPED RICE CAKE?",o:["BIBINGKA","PUTO","SUMAN","KUTSINTA"],a:2,c:"FOOD"},{q:"WHICH PROVINCE IS KNOWN AS THE 'RICE GRANARY OF THE PHILIPPINES'?",o:["BULACAN","NUEVA ECIJA","PAMPANGA","TARLAC"],a:1,c:"GEOGRAPHY"},{q:"WHAT FESTIVAL IS CELEBRATED IN CEBU EVERY THIRD SUNDAY OF JANUARY?",o:["SINULOG","ATI-ATIHAN","DINAGYANG","PAHIYAS"],a:0,c:"CULTURE"},{q:"WHAT IS THE CAPITAL OF THE PHILIPPINES?",o:["CEBU","DAVAO","MANILA","QUEZON CITY"],a:2,c:"GEOGRAPHY"},{q:"WHICH PHILIPPINE VOLCANO ERUPTED IN 1991?",o:["MAYON","TAAL","PINATUBO","KANLAON"],a:2,c:"GEOGRAPHY"},{q:"WHAT IS THE TRADITIONAL FILIPINO MARTIAL ART?",o:["KARATE","TAEKWONDO","ARNIS","KUNG FU"],a:2,c:"CULTURE"},{q:"WHICH FILIPINO BOXER BECAME AN EIGHT-DIVISION WORLD CHAMPION?",o:["MANNY PACQUIAO","NONITO DONAIRE","FLASH ELORDE","PANCHO VILLA"],a:0,c:"SPORTS"},{q:"WHAT IS THE NATIONAL FLOWER OF THE PHILIPPINES?",o:["SAMPAGUITA","ROSE","ORCHID","GUMAMELA"],a:0,c:"NATIONAL SYMBOLS"}];function lh(){const e=localStorage.getItem('pinoySpaceInvaderHighScores');e?hs=JSON.parse(e):hs=[{n:"GERBIE",s:1e4},{n:"JAMES",s:9e3},{n:"ERICKA",s:8e3},{n:"JUSTIN",s:7e3},{n:"JHAYMIE",s:6e3},{n:"EDMEL",s:5e3}]}function sh(){localStorage.setItem('pinoySpaceInvaderHighScores',JSON.stringify(hs))}function ah(e,t){hs.push({n:e.toUpperCase(),s:t}),hs.sort((e,t)=>t.s-e.s),hs=hs.slice(0,mhs),sh()}function ls(){const e=localStorage.getItem('pinoySpaceInvaderSettings');e&&(s=JSON.parse(e),us())}function ss(){localStorage.setItem('pinoySpaceInvaderSettings',JSON.stringify(s)),us()}function us(){document.getElementById('musicVolume').textContent=`${Math.round(100*s.mv)}%`,document.getElementById('toggleSound').textContent=s.se?'ON':'OFF',document.getElementById('changeDifficulty').textContent=s.d.toUpperCase(),bgm.volume=s.mv,Object.values(snd).forEach(e=>{e.volume=s.se?.5:0}),'easy'===s.d?(p.s=6,ess=.8,esh=150):'normal'===s.d?(p.s=5,ess=1,esh=120):'hard'===s.d&&(p.s=4,ess=1.2,esh=90)}function ig(){lh(),ls(),r(),document.getElementById('playButton').addEventListener('click',()=>{snd.ms.play(),so()}),document.getElementById('settingsWheel').addEventListener('click',()=>{snd.mo.play(),ss()}),window.addEventListener('keydown',e=>{'Escape'===e.key&&g===STATE_PLAYING&&(snd.mo.play(),ss())}),document.getElementById('continueFromObjectives').addEventListener('click',()=>{snd.ms.play(),sg()}),document.getElementById('highscoreButton').addEventListener('click',()=>{snd.ms.play(),shs()}),document.getElementById('settingsButton').addEventListener('click',()=>{snd.ms.play(),ss()}),document.getElementById('tutorialButton').addEventListener('click',()=>{snd.ms.play(),st()}),document.getElementById('continueButton').addEventListener('click',()=>{snd.ms.play(),rm()}),document.getElementById('winContinueButton').addEventListener('click',()=>{snd.ms.play(),rm()}),document.getElementById('backButton').addEventListener('click',()=>{snd.ms.play(),rm()}),document.getElementById('settingsBackButton').addEventListener('click',()=>{snd.ms.play(),ss(),rg()}),document.getElementById('tutorialBackButton').addEventListener('click',()=>{snd.ms.play(),rm()}),document.getElementById('submitScore').addEventListener('click',()=>{snd.ms.play(),sps()}),document.getElementById('submitScoreWin').addEventListener('click',()=>{snd.ms.play(),spsw()}),document.getElementById('startWaveButton').addEventListener('click',()=>{snd.ms.play(),sw()});const e=document.querySelectorAll('.menu-button');e.forEach(e=>{e.addEventListener('mouseenter',()=>{snd.mh.play()})}),document.getElementById('musicDown').addEventListener('click',()=>{snd.ms.play(),s.mv=Math.max(0,s.mv-.1),us()}),document.getElementById('musicUp').addEventListener('click',()=>{snd.ms.play(),s.mv=Math.min(1,s.mv+.1),us()}),document.getElementById('toggleSound').addEventListener('click',()=>{snd.ms.play(),s.se=!s.se,us()}),document.getElementById('changeDifficulty').addEventListener('click',()=>{snd.ms.play();const e=['easy','normal','hard'],t=e.indexOf(s.d);s.d=e[(t+1)%e.length],us()}),document.getElementById('leftBtn').addEventListener('touchstart',()=>{k.ArrowLeft=!0}),document.getElementById('leftBtn').addEventListener('touchend',()=>{k.ArrowLeft=!1}),document.getElementById('rightBtn').addEventListener('touchstart',()=>{k.ArrowRight=!0}),document.getElementById('rightBtn').addEventListener('touchend',()=>{k.ArrowRight=!1}),document.getElementById('shootBtn').addEventListener('touchstart',()=>{k[' ']=!0}),document.getElementById('shootBtn').addEventListener('touchend',()=>{k[' ']=!1}),document.getElementById('specialBtn').addEventListener('touchstart',()=>{k.b=!0}),document.getElementById('specialBtn').addEventListener('touchend',()=>{k.b=!1}),document.getElementById('defaultShip').addEventListener('click',()=>{p.as.a&&(p.sk='a',p.as.a=!1,snd.sc.play(),usu())}),document.getElementById('bangkaShip').addEventListener('click',()=>{p.as.b&&(p.sk='b',p.as.b=!1,snd.sc.play(),usu())}),document.getElementById('jeepneyShip').addEventListener('click',()=>{p.as.j&&(p.sk='j',p.as.j=!1,snd.sc.play(),usu())}),document.getElementById('triviaOptions').innerHTML='',document.getElementById('quizOptions').addEventListener('click',e=>{e.target.classList.contains('quiz-option')&&cqa(Array.from(e.target.parentElement.children).indexOf(e.target))}),window.addEventListener('keydown',e=>{e.key in k&&(k[e.key]=!0),g===STATE_PLAYING&&('x'===e.key.toLowerCase()&&p.as.a?(p.sk='a',p.as.a=!1,snd.sc.play(),usu()):'c'===e.key.toLowerCase()&&p.as.b?(p.sk='b',p.as.b=!1,snd.sc.play(),usu()):'v'===e.key.toLowerCase()&&p.as.j?(p.sk='j',p.as.j=!1,snd.sc.play(),usu()):'z'===e.key.toLowerCase()&&(ba||wt)&&sobp():'t'===e.key.toLowerCase()&&p.tl>=TRIVIA_LASER_MAX?ftl():'b'===e.key.toLowerCase()&&asa()),(g===STATE_GAME_OVER||g===STATE_WIN)&&(document.getElementById('nameInputContainer').style.display!=='none'||document.getElementById('nameInputContainerWin').style.display!=='none')&&'Enter'===e.key&&(g===STATE_GAME_OVER?sps():spsw())}),window.addEventListener('keyup',e=>{e.key in k&&(k[e.key]=!1)}),requestAnimationFrame(gl)}const k={ArrowLeft:!1,ArrowRight:!1,' ':!1,z:!1,t:!1,b:!1};function asa(){const e=p.sa[p.sk];e.c<=0&&('a'===p.sk?(p.p.bs=!0,pt.bs=180,e.c=e.m,up(),usk(),snd.sh.play()):'b'===p.sk&&p.d.b<3&&(p.d.b=Math.min(3,p.d.b+1),e.c=e.m,ud(),usk(),snd.hl.play():'j'===p.sk&&(p.p.jb=!0,pt.jb=120,e.c=e.m,up(),usk(),snd.pu.play()))}function usk(){const e=document.getElementById('specialKey'),t=p.sa[p.sk];e.querySelector('.cooldown')&&e.removeChild(e.querySelector('.cooldown')),t.c>0&&(e.innerHTML+='<div class="cooldown" style="height:'+100*t.c/t.m+'%"></div>')}function usu(){const e=document.getElementById('defaultShip'),t=document.getElementById('bangkaShip'),n=document.getElementById('jeepneyShip');e.classList.toggle('available',p.as.a),t.classList.toggle('available',p.as.b),n.classList.toggle('available',p.as.j),usk()}function ud(){document.getElementById('defaultDurabilityIcons').innerHTML='',document.getElementById('bangkaDurabilityIcons').innerHTML='',document.getElementById('jeepneyDurabilityIcons').innerHTML='';for(let e=0;e<p.d.a;e++)document.getElementById('defaultDurabilityIcons').innerHTML+='<div class="durability-icon default"></div>';for(let e=0;e<p.d.b;e++)document.getElementById('bangkaDurabilityIcons').innerHTML+='<div class="durability-icon bangka"></div>';for(let e=0;e<p.d.j;e++)document.getElementById('jeepneyDurabilityIcons').innerHTML+='<div class="durability-icon jeepney"></div>';const e=document.querySelector('.ship-durability-row:nth-child(2)'),t=document.querySelector('.ship-durability-row:nth-child(3)'),n=document.querySelector('.ship-durability-row:nth-child(4)');e.style.color='a'===p.sk?'#FD0':'#fff',t.style.color='b'===p.sk?'#FD0':'#fff',n.style.color='j'===p.sk?'#FD0':'#fff'}function up(){let e=[];p.p.bs&&e.push("BARONG SHIELD"),p.p.jb&&e.push("JEEPNEY BOOST"),p.p.tm&&e.push("TINIKLING MODE"),document.getElementById('powerupStatus').textContent=e.length>0?e.join(", "):"NONE"}function utl(){const e=100*p.tl/TRIVIA_LASER_MAX;document.getElementById('triviaLaserFill').style.width=e+'%'}function ftl(){if(!(p.tl>=TRIVIA_LASER_MAX))return;snd.ls.play(),p.tl=0,utl();const e=document.getElementById('laserBeam');e.style.opacity='1',setTimeout(()=>{e.style.opacity='0'},300);for(let t=e.length-1;t>=0;t--){const n=e[t];let o=0;'k'===n.type?o=100*w:'s'===n.type?o=50*w:o=30*w,p.sc+=o,e.splice(t,1),snd.ex.play()}eb=[],uh()}function rm(){g=STATE_MENU,dge('gameOverScreen').style.display='none',dge('winScreen').style.display='none',dge('highscoreScreen').style.display='none',dge('settingsScreen').style.display='none',dge('tutorialScreen').style.display='none',dge('waveScreen').style.display='none',dge('quizScreen').style.display='none',dge('objectivesScreen').style.display='none',dge('menuScreen').style.display='flex',dge('gameOverCover').style.display='none',dge('pauseOverlay').style.display='none',dge('hud').style.display='none',dge('durabilityHud').style.display='none',dge('powerupHud').style.display='none',dge('bossHealthBar').style.display='none',dge('triviaContainer').style.display='none',dge('shipSelection').style.display='none',dge('comboCounter').style.display='none',dge('waveIndicator').style.display='none',dge('timerContainer').style.display='none',dge('triviaLaserHud').style.display='none',dge('waveTransitionMessage').style.display='none',dge('waveTransitionTimer').style.display='none',dge('specialKey').style.display='none',dge('settingsWheel').style.display='none',bgm.pause()}function rg(){g=STATE_PLAYING,dge('settingsScreen').style.display='none',dge('pauseOverlay').style.display='none'}function sps(){const e=dge('nameInput'),t=e.value.trim();''!==t&&(ah(t,p.sc),e.value='',dge('nameInputContainer').style.display='none',dge('continueButton').style.display='block',shs())}function spsw(){const e=dge('nameInputWin'),t=e.value.trim();''!==t&&(ah(t,p.sc),e.value='',dge('nameInputContainerWin').style.display='none',dge('winContinueButton').style.display='block',shs())}function st(){g=STATE_TUTORIAL,dge('menuScreen').style.display='none',dge('tutorialScreen').style.display='flex'}function sg(){g=STATE_WAVE,dge('menuScreen').style.display='none',dge('objectivesScreen').style.display='none',p={x:W/2-25,y:H-90,w:50,h:30,s:5,d:{a:3,b:3,j:3},sc:0,p:{bs:0,jb:0,tm:0},sk:'a',as:{a:1,b:0,j:0},tl:0,sa:{a:{c:0,m:300},b:{c:0,m:450},j:{c:0,m:240}}},b=[],e=[],eb=[],pw=[],bc=0,esr=60,est=0,esh=0,cc=0,ct=0,w=1,eiw=0,ed=0,wdm=1,ba=0,bh=0,bmh=0,cq=0,so=0,asm=0,qst=0,qtl=15,qt=0,qca=0,tba=0,tbt=0,tbd=5,sma=0,smt=0,wt=0,wtd=600,wc=10,sws(),uh(),ud(),up(),usu(),utl(),dge('bossHealthBar').style.display='none',dge('triviaContainer').style.display='none',dge('timerContainer').style.display='none',dge('waveTransitionMessage').style.display='none',dge('waveTransitionTimer').style.display='none',bgm.currentTime=0,bgm.play().catch(e=>console.log("Autoplay prevented:",e))}function so(){g=STATE_OBJECTIVES,dge('menuScreen').style.display='none',dge('objectivesScreen').style.display='flex'}function sws(){g=STATE_WAVE,dge('waveDisplay').textContent=w;let e="GET READY!";w===BOSS_WAVE?e="FINAL BOSS!":w>1&&(e=`WAVE ${w}`),dge('waveSubtitle').textContent=e,dge('waveScreen').style.display='flex'}function sw(){g=STATE_PLAYING,dge('waveScreen').style.display='none',dge('hud').style.display='block',dge('durabilityHud').style.display='block',dge('powerupHud').style.display='block',dge('shipSelection').style.display='flex',dge('specialKey').style.display='flex',dge('comboCounter').style.display='none',dge('waveIndicator').style.display='block',dge('waveNumber').textContent=w,dge('triviaLaserHud').style.display='block',dge('settingsWheel').style.display='block',ed=0,eiw=5+Math.floor(1.5*w),ess=1*wdm,esh=Math.max(30,120-5*w*wdm),w===BOSS_WAVE&&sb()}function shs(){g=STATE_HIGHSCORE,dge('menuScreen').style.display='none',dge('highscoreScreen').style.display='flex';const e=dge('highscoreList');e.innerHTML='',hs.forEach((t,n)=>{const o=document.createElement('div');o.style.margin='5px',o.textContent=`${n+1}. ${t.n} - ${t.s}`,e.appendChild(o)})}function ss(){g===STATE_PLAYING&&(dge('pauseOverlay').style.display='flex'),g=STATE_SETTINGS,dge('menuScreen').style.display='none',dge('settingsScreen').style.display='flex'}function go(){g=STATE_GAME_OVER,dge('gameOverScreen').style.display='flex',dge('finalScore').textContent=`FINAL SCORE: ${p.sc}`,dge('gameOverCover').style.display='block';const e=hs.length<mhs||p.sc>hs[hs.length-1].s;e?(dge('nameInputContainer').style.display='flex',dge('continueButton').style.display='none',dge('nameInput').focus()):(dge('nameInputContainer').style.display='none',dge('continueButton').style.display='block')}function pw(){g=STATE_WIN,dge('winScreen').style.display='flex',dge('winScore').textContent=`FINAL SCORE: ${p.sc}`,dge('gameOverCover').style.display='block',snd.wn.play();const e=hs.length<mhs||p.sc>hs[hs.length-1].s;e?(dge('nameInputContainerWin').style.display='flex',dge('winContinueButton').style.display='none',dge('nameInputWin').focus()):(dge('nameInputContainerWin').style.display='none',dge('winContinueButton').style.display='block'),dge('hud').style.display='none',dge('durabilityHud').style.display='none',dge('powerupHud').style.display='none',dge('bossHealthBar').style.display='none',dge('triviaContainer').style.display='none',dge('shipSelection').style.display='none',dge('comboCounter').style.display='none',dge('waveIndicator').style.display='none',dge('timerContainer').style.display='none',dge('triviaLaserHud').style.display='none',dge('waveTransitionMessage').style.display='none',dge('waveTransitionTimer').style.display='none',dge('specialKey').style.display='none',dge('settingsWheel').style.display='none'}function sb(){ba=!0,asm=!0,boss={x:W/2-75,y:50,w:150,h:120,s:1,h:20+5*w},bmh=boss.h,dge('bossHealthBar').style.display='block',ubh();const e=dge('triviaContainer');e.style.display='block',e.style.opacity='0',e.style.transform='translateX(-50%) translateY(20px)',setTimeout(()=>{e.style.opacity='1',e.style.transform='translateX(-50%) translateY(0)',e.style.transition='all 0.3s ease-out'},100),sbq(),snd.bs.play()}function ubh(){const e=100*boss.h/bmh;dge('bossHealth').style.width=e+'%'}function sbq(){cq=tq[Math.floor(Math.random()*tq.length)],so=0;const e=dge('triviaQuestion');e.textContent=cq.q;const t=dge('triviaOptions');t.innerHTML='',cq.o.forEach((e,n)=>{const o=document.createElement('div');o.className='triviaOption',o.textContent=e,o.dataset.index=n,t.appendChild(o)}),uoh()}function swt(){wt=!0,asm=!0,dge('waveTransitionMessage').textContent=`APPROACHING WAVE ${w+1}!`,dge('waveTransitionMessage').style.display='block',dge('timerContainer').style.display='block',dge('timerBar').style.width='100%',dge('waveTransitionTimer').textContent=wc,dge('waveTransitionTimer').style.display='block';const e=dge('triviaContainer');e.style.display='block',cq=tq[Math.floor(Math.random()*tq.length)],so=0,dge('triviaQuestion').textContent=cq.q;const t=dge('triviaOptions');t.innerHTML='',cq.o.forEach((e,n)=>{const o=document.createElement('div');o.className='triviaOption',o.textContent=e,o.dataset.index=n,t.appendChild(o)}),qst=Date.now(),qt=qtl;const n=setInterval(()=>{if(!wt)return clearInterval(n);const e=Math.floor((Date.now()-qst)/1e3);qt=Math.max(0,qtl-e),o=100*qt/qtl;dge('timerBar').style.width=o+'%',wc=Math.max(0,10-e),dge('waveTransitionTimer').textContent=wc,qt<=0&&(clearInterval(n),cwta(-1))},200)}function uoh(){if(!(ba||wt)||!cq)return;const e=document.querySelectorAll('#triviaOptions .triviaOption'),t=dge('triviaContainer'),n=t.getBoundingClientRect(),o=c.getBoundingClientRect(),a=p.x+p.w/2,s=o.left+a,l=s-n.left;let i=-1;e.forEach((e,t)=>{const a=e.getBoundingClientRect(),s=a.left-n.left,c=a.right-n.left;e.classList.remove('highlighted'),l>=s&&l<=c&&(i=t)}),i>=0&&e[i].classList.add('highlighted')}function sobp(){if(null!==so)return;const e=document.querySelectorAll('#triviaOptions .triviaOption'),t=dge('triviaContainer'),n=t.getBoundingClientRect(),o=c.getBoundingClientRect(),a=p.x+p.w/2,s=o.left+a,l=s-n.left;let i=-1;e.forEach((e,t)=>{const a=e.getBoundingClientRect(),s=a.left-n.left,c=a.right-n.left;l>=s&&l<=c&&(i=t)}),i>=0&&(ba?sbo(i):wt&&cwta(i))}function sbo(e){if(null!==so)return;so=e;const t=document.querySelectorAll('#triviaOptions .triviaOption');t.forEach(e=>e.classList.remove('highlighted')),e===cq.a?(t[e].classList.add('selected'),sf(!0),boss.h-=p.p.tm?3:2,ubh(),boss.h<=0?(p.sc+=1e3*w,uh(),ba=!1,asm=!1,dge('bossHealthBar').style.display='none',dge('triviaContainer').style.display='none',snd.ex.play(),e=[],setTimeout(pw,1e3)):setTimeout(sbq,1e3)):(t[e].classList.add('incorrect'),sf(!1),p.p.bs||(p.d[p.sk]--,ud(),p.d.a<=0&&p.d.b<=0&&p.d.j<=0?go():p.d[p.sk]<=0&&(p.d.a>0?p.sk='a':p.d.b>0?p.sk='b':p.d.j>0&&(p.sk='j'))),setTimeout(sbq,1e3))}function sf(e){const t=e?dge('correctFeedback'):dge('incorrectFeedback');t.style.display='block',snd[e?'co':'w'].play(),setTimeout(()=>{t.style.display='none'},1e3)}function cwta(e){const t=e===cq.a;t?(sf(!0),qca++,p.tl=Math.min(TRIVIA_LASER_MAX,p.tl+33),utl();const n=(Date.now()-qst)/1e3,o=Math.max(1,qtl-n);t&&o>=.7*qtl?(sma=!0,smt=tbd,snd.sm.play(),document.body.style.backgroundColor='rgba(0,0,100,0.5)'):t&&o>=.3*qtl&&(tba=!0,tbt=tbd,p.p.bs=!0,up()),wdm=Math.max(.5,.9*wdm)):(sf(!1),p.tl=Math.max(0,p.tl-15),utl(),wdm=Math.min(2,1.2*wdm),ess*=1.2,esh=Math.max(30,.8*esh)),dge('triviaContainer').style.display='none',dge('timerContainer').style.display='none',dge('waveTransitionMessage').style.display='none',dge('waveTransitionTimer').style.display='none',wc=10,wt=!1,asm=!1,w++,sw()}function uh(){dge('scoreDisplay').textContent=p.sc,dge('comboCount').textContent=cc+'x',ud(),up()}function sc(){cc>3&&(dge('comboCounter').textContent=cc+' KILL COMBO!',dge('comboCounter').style.display='block',cc>=10?(dge('comboCounter').style.color='#F00',dge('comboCounter').style.fontSize='28px'):cc>=7?(dge('comboCounter').style.color='#FA0',dge('comboCounter').style.fontSize='24px'):(dge('comboCounter').style.color='#FF0',dge('comboCounter').style.fontSize='20px'),setTimeout(()=>{dge('comboCounter').style.display='none'},1500))}class Enemy{constructor(){this.type=['k','a','s'][Math.floor(3*Math.random())],'k'===this.type?(this.w=60,this.h=50,this.hl=3,this.s=.7*ess,this.sc=.3):'a'===this.type?(this.w=30,this.h=20,this.hl=1,this.s=1.5*ess,this.sc=.5):(this.w=45,this.h=45,this.hl=2,this.s=ess,this.sc=.4),this.x=Math.random()*(W-this.w),this.y=-this.h}update(){this.y+=this.s*(sma?.5:1)}draw(){x.save(),x.globalCompositeOperation='source-over','k'===this.type?(x.fillStyle='#222',x.fillRect(Math.round(this.x),Math.round(this.y),Math.round(this.w),Math.round(this.h)),x.fillStyle='#111',x.beginPath(),x.arc(Math.round(this.x+this.w/2),Math.round(this.y+20),15,0,2*Math.PI),x.fill(),x.fillStyle='red',x.beginPath(),x.arc(Math.round(this.x+this.w/2-10),Math.round(this.y+15),5,0,2*Math.PI),x.arc(Math.round(this.x+this.w/2+10),Math.round(this.y+15),5,0,2*Math.PI),x.fill(),x.shadowColor='red',x.shadowBlur=10,x.fill(),x.shadowBlur=0,x.fillStyle='#fff');for(let e=0;e<5;e++)x.beginPath(),x.moveTo(Math.round(this.x+this.w/2-12+5*e),Math.round(this.y+25)),x.lineTo(Math.round(this.x+this.w/2-14+5*e),Math.round(this.y+35)),x.lineTo(Math.round(this.x+this.w/2-10+5*e),Math.round(this.y+35)),x.closePath(),x.fill();x.fillStyle='rgba(200,200,200,0.7)');for(let e=0;e<3;e++)x.beginPath(),x.arc(Math.round(this.x+this.w/2+15+5*e),Math.round(this.y+15-3*e),3+e,0,2*Math.PI),x.fill()):'a'===this.type?(x.fillStyle='#400040',x.beginPath(),x.moveTo(Math.round(this.x+this.w/2),Math.round(this.y)),x.lineTo(Math.round(this.x),Math.round(this.y+this.h)),x.lineTo(Math.round(this.x+this.w),Math.round(this.y+this.h)),x.closePath(),x.fill(),x.fillStyle='#fff',x.beginPath(),x.arc(Math.round(this.x+this.w/3),Math.round(this.y+this.h/2),4,0,2*Math.PI),x.arc(Math.round(this.x+2*this.w/3),Math.round(this.y+this.h/2),4,0,2*Math.PI),x.fill(),x.fillStyle='red',x.beginPath(),x.moveTo(Math.round(this.x+this.w/2),Math.round(this.y+this.h-5)),x.lineTo(Math.round(this.x+this.w/2-5),Math.round(this.y+this.h+5)),x.lineTo(Math.round(this.x+this.w/2+5),Math.round(this.y+this.h+5)),x.closePath(),x.fill(),x.shadowColor='#800080',x.shadowBlur=10,x.fill(),x.shadowBlur=0):(x.fillStyle='#FD0',x.beginPath(),x.moveTo(Math.round(this.x+this.w/2),Math.round(this.y)),x.lineTo(Math.round(this.x),Math.round(this.y+this.h)),x.lineTo(Math.round(this.x+this.w),Math.round(this.y+this.h)),x.closePath(),x.fill(),x.fillStyle='#F40',x.beginPath(),x.moveTo(Math.round(this.x+this.w/2),Math.round(this.y+10)),x.lineTo(Math.round(this.x+this.w/2-5),Math.round(this.y+20)),x.lineTo(Math.round(this.x+this.w/2+5),Math.round(this.y+20)),x.closePath(),x.fill(),x.fillStyle='red',x.beginPath(),x.arc(Math.round(this.x+this.w/3),Math.round(this.y+15),3,0,2*Math.PI),x.arc(Math.round(this.x+2*this.w/3),Math.round(this.y+15),3,0,2*Math.PI),x.fill(),x.fillStyle='#F00');for(let e=0;e<3;e++)x.beginPath(),x.moveTo(Math.round(this.x+this.w/2),Math.round(this.y+this.h-5)),x.lineTo(Math.round(this.x+this.w/2-10+10*e),Math.round(this.y+this.h+15)),x.lineTo(Math.round(this.x+this.w/2-5+10*e),Math.round(this.y+this.h+15)),x.closePath(),x.fill()),x.restore()}isOffScreen(){return this.y>H}hit(){return this.hl--,this.hl<=0}shoot(){Math.random()<this.sc&&(eb.push({x:this.x+this.w/2,y:this.y+this.h,w:5,h:10,s:3*(sma?.5:1)}),snd.es.play())}}class Bullet{constructor(e,t){this.x=e,this.y=t,this.r=5,this.s=7*(sma?1.5:1),this.d=p.p.tm?2:1}update(){this.y-=this.s}draw(){x.save(),x.globalCompositeOperation='source-over',x.fillStyle='#FF0',x.beginPath(),x.arc(Math.round(this.x),Math.round(this.y),this.r,0,2*Math.PI),x.fill(),x.shadowColor='#FF0',x.shadowBlur=5,x.fill(),x.shadowBlur=0,x.restore()}isOffScreen(){return this.y<0}}class SP{constructor(e,t,n){this.x=e,this.y=t,this.w=40,this.h=40,this.s=2*(sma?.5:1),this.t=n,this.r=0,this.rs=.01*Math.random()-.005,this.p=0,this.ps=.02+.05*Math.random()}update(){this.y+=this.s,this.r+=this.rs,this.p+=this.ps}draw(){x.save(),x.globalCompositeOperation='source-over',x.translate(Math.round(this.x+this.w/2),Math.round(this.y+this.h/2)),x.rotate(this.r);const e=1+.1*Math.sin(this.p);x.scale(e,e),'a'===this.t?(x.fillStyle='#4CAF50',x.beginPath(),x.moveTo(0,Math.round(-this.h/2)),x.lineTo(Math.round(-this.w/2),Math.round(this.h/4)),x.lineTo(Math.round(-this.w/4),Math.round(this.h/2)),x.lineTo(Math.round(this.w/4),Math.round(this.h/2)),x.lineTo(Math.round(this.w/2),Math.round(this.h/4)),x.closePath(),x.fill(),x.fillStyle='#87CEEB',x.beginPath(),x.arc(0,Math.round(-this.h/4),5,0,2*Math.PI),x.fill(),x.fillStyle='rgba(255,255,0,0.7)',x.beginPath(),x.moveTo(Math.round(-this.w/4),Math.round(this.h/2)),x.lineTo(0,Math.round(this.h/2+5)),x.lineTo(Math.round(this.w/4),Math.round(this.h/2)),x.closePath(),x.fill(),x.shadowColor='#4CAF50',x.shadowBlur=15,x.fill(),x.shadowBlur=0):'b'===this.t?(x.fillStyle='#5D2906',x.beginPath(),x.moveTo(0,Math.round(-this.h/4)),x.lineTo(Math.round(-this.w/2),Math.round(this.h/4)),x.lineTo(Math.round(this.w/2),Math.round(this.h/4)),x.closePath(),x.fill(),x.fillStyle='#630',x.beginPath(),x.moveTo(Math.round(-this.w/3),Math.round(-this.h/8)),x.lineTo(Math.round(this.w/3),Math.round(-this.h/8)),x.lineTo(Math.round(this.w/4),Math.round(this.h/4)),x.lineTo(Math.round(-this.w/4),Math.round(this.h/4)),x.closePath(),x.fill(),x.fillStyle='#5D2906',x.fillRect(Math.round(-this.w/2-10),Math.round(-this.h/8),10,5),x.fillRect(Math.round(this.w/2),Math.round(-this.h/8),10,5),x.fillStyle='#fff',x.beginPath(),x.moveTo(0,Math.round(-this.h/3)),x.lineTo(Math.round(-this.w/4),Math.round(this.h/8)),x.lineTo(Math.round(this.w/4),Math.round(this.h/8)),x.closePath(),x.fill(),x.strokeStyle='#630',x.lineWidth=1,x.beginPath(),x.moveTo(0,Math.round(-this.h/3)),x.lineTo(0,Math.round(this.h/8)),x.stroke(),x.shadowColor='#630',x.shadowBlur=15,x.fill(),x.shadowBlur=0):(x.fillStyle='#FD0',x.fillRect(Math.round(-this.w/2),Math.round(-this.h/2),Math.round(this.w),Math.round(this.h)),x.fillStyle='#F00',x.fillRect(Math.round(-this.w/2+5),Math.round(-this.h/2+5),Math.round(this.w-10),Math.round(this.h-10)),x.fillStyle='#87CEEB',x.fillRect(Math.round(-this.w/2+10),Math.round(-this.h/2+10),10,10),x.fillRect(Math.round(this.w/2-20),Math.round(-this.h/2+10),10,10),x.fillStyle='#fff',x.beginPath(),x.arc(Math.round(-this.w/2+5),Math.round(-this.h/4),3,0,2*Math.PI),x.arc(Math.round(this.w/2-5),Math.round(-this.h/4),3,0,2*Math.PI),x.fill(),x.fillStyle='#FD0');for(let e=0;e<3;e++)x.fillRect(Math.round(-this.w/2+5),Math.round(-this.h/2+20+8*e),Math.round(this.w-10),3);x.shadowColor='#FD0',x.shadowBlur=15,x.fill(),x.shadowBlur=0),x.restore()}isOffScreen(){return this.y>H}}class P{constructor(e,t,n=null){this.x=e,this.y=t,this.w=30,this.h=30,this.s=2*(sma?.5:1),this.t=n||['bs','jb','tm'][Math.floor(3*Math.random())],this.r=0,this.rs=.02*Math.random()-.01,this.p=0,this.ps=.02+.05*Math.random()}update(){this.y+=this.s,this.r+=this.rs,this.p+=this.ps}draw(){x.save(),x.globalCompositeOperation='source-over',x.translate(Math.round(this.x+this.w/2),Math.round(this.y+this.h/2)),x.rotate(this.r);const e=1+.2*Math.sin(this.p);x.scale(e,e),'bs'===this.t?(x.fillStyle='rgba(0,0,255,0.8)',x.beginPath(),x.arc(0,0,Math.round(this.w/2),0,2*Math.PI),x.fill(),x.fillStyle='rgba(255,255,255,0.9)',x.beginPath(),x.moveTo(0,Math.round(-this.h/2+5)),x.lineTo(Math.round(-this.w/2+5),0),x.lineTo(0,Math.round(this.h/2-5)),x.lineTo(Math.round(this.w/2-5),0),x.closePath(),x.fill(),x.fillStyle='rgba(0,0,200,0.8)',x.beginPath(),x.arc(0,0,Math.round(this.w/4),0,2*Math.PI),x.fill(),x.shadowColor='blue',x.shadowBlur=15,x.fill(),x.shadowBlur=0):'jb'===this.t?(x.fillStyle='rgba(255,0,0,0.8)',x.beginPath(),x.arc(0,0,Math.round(this.w/2),0,2*Math.PI),x.fill(),x.fillStyle='rgba(255,255,0,0.9)',x.beginPath(),x.moveTo(0,Math.round(-this.h/2+5)),x.lineTo(Math.round(-this.w/4),Math.round(-this.h/4)),x.lineTo(Math.round(-this.w/2+5),0),x.lineTo(Math.round(-this.w/4),Math.round(this.h/4)),x.lineTo(0,Math.round(this.h/2-5)),x.lineTo(Math.round(this.w/4),Math.round(this.h/4)),x.lineTo(Math.round(this.w/2-5),0),x.lineTo(Math.round(this.w/4),Math.round(-this.h/4)),x.closePath(),x.fill(),x.fillStyle='rgba(200,0,0,0.8)',x.beginPath(),x.arc(0,0,Math.round(this.w/4),0,2*Math.PI),x.fill(),x.shadowColor='red',x.shadowBlur=15,x.fill(),x.shadowBlur=0):(x.fillStyle='rgba(0,255,0,0.8)',x.beginPath(),x.arc(0,0,Math.round(this.w/2),0,2*Math.PI),x.fill(),x.fillStyle='rgba(255,255,255,0.9)',x.beginPath(),x.moveTo(Math.round(-this.w/4),Math.round(-this.h/4)),x.lineTo(Math.round(this.w/4),Math.round(-this.h/4)),x.lineTo(Math.round(this.w/4),Math.round(this.h/4)),x.lineTo(Math.round(-this.w/4),Math.round(this.h/4)),x.closePath(),x.fill(),x.fillStyle='rgba(0,200,0,0.8)',x.beginPath(),x.moveTo(Math.round(-this.w/8),Math.round(-this.h/8)),x.lineTo(Math.round(this.w/8),Math.round(-this.h/8)),x.lineTo(Math.round(this.w/8),Math.round(this.h/8)),x.lineTo(Math.round(-this.w/8),Math.round(this.h/8)),x.closePath(),x.fill(),x.shadowColor='green',x.shadowBlur=15,x.fill(),x.shadowBlur=0),x.restore()}isOffScreen(){return this.y>H}}const pt={bs:0,jb:0,tm:0},pd=300;function upt(){for(const e in pt)pt[e]>0&&(pt[e]--,0===pt[e]&&(p.p[e]=!1,up()));for(const e in p.sa)p.sa[e].c>0&&(p.sa[e].c--,usk());tba&&(tbt--,0>=tbt&&(tba=!1,p.p.bs=!1,up())),sma&&(smt--,0>=smt&&(sma=!1,document.body.style.backgroundColor='#000')),wt&&(wt--,0>=wt&&cwta(-1))}function dp(){x.save(),x.globalCompositeOperation='source-over',ba||wt?(x.strokeStyle='rgba(0,255,255,0.7)',x.lineWidth=3,x.beginPath(),x.arc(Math.round(p.x+p.w/2),Math.round(p.y+p.h/2),Math.round((p.w+p.h)/2)+8,0,2*Math.PI),x.stroke(),x.shadowColor='cyan',x.shadowBlur=15,x.stroke(),x.shadowBlur=0):p.p.bs&&(x.strokeStyle='rgba(0,0,255,0.7)',x.lineWidth=3,x.beginPath(),x.arc(Math.round(p.x+p.w/2),Math.round(p.y+p.h/2),Math.round((p.w+p.h)/2)+8,0,2*Math.PI),x.stroke(),x.shadowColor='blue',x.shadowBlur=15,x.stroke(),x.shadowBlur=0),'a'===p.sk?(x.fillStyle='#4CAF50',x.beginPath(),x.moveTo(Math.round(p.x+p.w/2),Math.round(p.y)),x.lineTo(Math.round(p.x),Math.round(p.y+p.h)),x.lineTo(Math.round(p.x+p.w),Math.round(p.y+p.h)),x.closePath(),x.fill(),x.fillStyle='#87CEEB',x.beginPath(),x.arc(Math.round(p.x+p.w/2),Math.round(p.y+p.h/3),5,0,2*Math.PI),x.fill(),(k.ArrowLeft||k.ArrowRight)&&(x.fillStyle='rgba(255,255,0,0.7)',x.beginPath(),x.moveTo(Math.round(p.x+p.w/2-5),Math.round(p.y+p.h)),x.lineTo(Math.round(p.x+p.w/2+5),Math.round(p.y+p.h)),x.lineTo(Math.round(p.x+p.w/2),Math.round(p.y+p.h+10)),x.closePath(),x.fill(),x.shadowColor='yellow',x.shadowBlur=10,x.fill(),x.shadowBlur=0),x.shadowColor='#4CAF50',x.shadowBlur=15,x.fill(),x.shadowBlur=0):'b'===p.sk?(x.fillStyle='#5D2906',x.beginPath(),x.moveTo(Math.round(p.x+p.w/2),Math.round(p.y+p.h/3)),x.lineTo(Math.round(p.x),Math.round(p.y+p.h)),x.lineTo(Math.round(p.x+p.w),Math.round(p.y+p.h)),x.closePath(),x.fill(),x.fillStyle='#630',x.beginPath(),x.moveTo(Math.round(p.x+p.w/3),Math.round(p.y+2*p.h/3)),x.lineTo(Math.round(p.x+2*p.w/3),Math.round(p.y+2*p.h/3)),x.lineTo(Math.round(p.x+3*p.w/4),Math.round(p.y+p.h)),x.lineTo(Math.round(p.x+p.w/4),Math.round(p.y+p.h)),x.closePath(),x.fill(),x.fillStyle='#5D2906',x.fillRect(Math.round(p.x-15),Math.round(p.y+p.h/2),15,5),x.fillRect(Math.round(p.x+p.w),Math.round(p.y+p.h/2),15,5),x.fillStyle='#fff',x.beginPath(),x.moveTo(Math.round(p.x+p.w/2),Math.round(p.y+p.h/3)),x.lineTo(Math.round(p.x+p.w/4),Math.round(p.y+3*p.h/4)),x.lineTo(Math.round(p.x+3*p.w/4),Math.round(p.y+3*p.h/4)),x.closePath(),x.fill(),x.strokeStyle='#630',x.lineWidth=1,x.beginPath(),x.moveTo(Math.round(p.x+p.w/2),Math.round(p.y+p.h/3)),x.lineTo(Math.round(p.x+p.w/2),Math.round(p.y+3*p.h/4)),x.stroke(),x.shadowColor='#630',x.shadowBlur=15,x.fill(),x.shadowBlur=0):(x.fillStyle='#FD0',x.fillRect(Math.round(p.x),Math.round(p.y),Math.round(p.w),Math.round(p.h)),x.fillStyle='#F00',x.fillRect(Math.round(p.x+5),Math.round(p.y+5),Math.round(p.w-10),Math.round(p.h-10)),x.fillStyle='#87CEEB',x.fillRect(Math.round(p.x+10),Math.round(p.y+10),10,10),x.fillRect(Math.round(p.x+p.w-20),Math.round(p.y+10),10,10),x.fillStyle='#fff',x.beginPath(),x.arc(Math.round(p.x+5),Math.round(p.y+15),3,0,2*Math.PI),x.arc(Math.round(p.x+p.w-5),Math.round(p.y+15),3,0,2*Math.PI),x.fill(),x.fillStyle='#FD0');for(let e=0;e<3;e++)x.fillRect(Math.round(p.x+5),Math.round(p.y+20+8*e),Math.round(p.w-10),3);x.shadowColor='#FD0',x.shadowBlur=15,x.fill(),x.shadowBlur=0),x.restore()}function db(){x.save(),x.globalCompositeOperation='source-over',x.fillStyle='#222',x.beginPath(),x.moveTo(boss.x+boss.w/2,boss.y+20),x.lineTo(boss.x+10,boss.y+boss.h),x.lineTo(boss.x+boss.w-10,boss.y+boss.h),x.closePath(),x.fill(),x.fillStyle='#111',x.beginPath(),x.arc(boss.x+boss.w/2,boss.y,25,0,2*Math.PI),x.fill(),x.fillStyle='red',x.beginPath(),x.arc(boss.x+boss.w/2-15,boss.y-5,5,0,2*Math.PI),x.arc(boss.x+boss.w/2+15,boss.y-5,5,0,2*Math.PI),x.fill(),x.shadowColor='red',x.shadowBlur=15,x.fill(),x.shadowBlur=0,x.fillStyle='black',x.fillRect(boss.x+boss.w/2-17,boss.y-7,4,10),x.fillRect(boss.x+boss.w/2+13,boss.y-7,4,10),x.fillStyle='#444',x.beginPath(),x.moveTo(boss.x+boss.w/2-15,boss.y-20),x.lineTo(boss.x+boss.w/2-25,boss.y-40),x.lineTo(boss.x+boss.w/2-20,boss.y-35),x.closePath(),x.fill(),x.moveTo(boss.x+boss.w/2+15,boss.y-20),x.lineTo(boss.x+boss.w/2+25,boss.y-40),x.lineTo(boss.x+boss.w/2+20,boss.y-35),x.closePath(),x.fill(),x.fillStyle='black',x.beginPath(),x.arc(boss.x+boss.w/2,boss.y+10,15,.2*Math.PI,.8*Math.PI,!0),x.fill(),x.fillStyle='#fff';for(let e=0;e<7;e++)x.beginPath(),x.moveTo(boss.x+boss.w/2-12+4*e,boss.y+10),x.lineTo(boss.x+boss.w/2-14+4*e,boss.y+20),x.lineTo(boss.x+boss.w/2-10+4*e,boss.y+20),x.closePath(),x.fill();x.fillStyle='#222',x.beginPath(),x.moveTo(boss.x+15,boss.y+40),x.lineTo(boss.x,boss.y+60),x.lineTo(boss.x-10,boss.y+55),x.lineTo(boss.x+5,boss.y+45),x.closePath(),x.fill(),x.beginPath(),x.moveTo(boss.x+boss.w-15,boss.y+40),x.lineTo(boss.x+boss.w,boss.y+60),x.lineTo(boss.x+boss.w+10,boss.y+55),x.lineTo(boss.x+boss.w-5,boss.y+45),x.closePath(),x.fill(),x.shadowColor='rgba(255,0,0,0.5)',x.shadowBlur=20,x.fill(),x.shadowBlur=0,x.restore()}function dge(e){return document.getElementById(e)}function gl(){x.fillStyle='rgba(0,0,0,0.2)',x.fillRect(0,0,W,H),x.fillStyle='#fff';for(let e=0;e<50;e++)x.fillRect(Math.round(Math.sin(1e-4*Date.now()+e)*W,Math.round((e*H/50+.05*Date.now())%H),2,2);if(g===STATE_PLAYING){ct>0&&!--ct&&(cc=0,uh()),(k.ArrowLeft||k.ArrowRight)&&(k.ArrowLeft&&(p.x-=p.s*(p.p.jb?1.5:1)*(sma?1.5:1)),p.x<0&&(p.x=0),k.ArrowRight&&(p.x+=p.s*(p.p.jb?1.5:1)*(sma?1.5:1)),p.x>W-p.w&&(p.x=W-p.w),(ba||wt)&&asm&&uoh(),!ba&&!asm&&ed>=eiw&&(asm=!0,swt(),wt=wtd),k[' ']&&bc<=0&&(b.push(new Bullet(p.x+p.w/2,p.y)),snd.s.currentTime=0,snd.s.play(),bc=15/(p.p.tm?2:1)),bc>0&&bc--,est++,!ba&&!asm&&ed<eiw&&est>=esr&&(e.push(new Enemy),est=0),esh++,esh>=120&&(esh=0,e.forEach(e=>e.shoot()));for(let t=eb.length-1;t>=0;t--){eb[t].y+=eb[t].s;if(!ba&&!asm&&eb[t].x+p.w>p.x&&eb[t].x<p.x+p.w&&eb[t].y+p.h>p.y&&eb[t].y<p.y+p.h&&!p.p.bs&&(p.d[p.sk]--,ud(),p.d[p.sk]<=0&&go()),eb[t].y>H&&eb.splice(t,1)}for(let t=b.length-1;t>=0;t--){b[t].y-=b[t].s;if(ba&&b[t].x>boss.x&&b[t].x<boss.x+boss.w&&b[t].y>boss.y&&b[t].y<boss.y+boss.h&&(boss.h--,ubh(),boss.h<=0&&(p.sc+=1e3*w,uh(),ba=!1,asm=!1,dge('bossHealthBar').style.display='none',dge('triviaContainer').style.display='none',snd.ex.play(),e=[],setTimeout(pw,1e3))),b[t].isOffScreen()&&b.splice(t,1)}for(let t=e.length-1;t>=0;t--){e[t].update();if(!ba&&!asm&&e[t].x+p.w>p.x&&e[t].x<p.x+p.w&&e[t].y+p.h>p.y&&e[t].y<p.y+p.h&&!p.p.bs&&(p.d[p.sk]--,ud(),p.d[p.sk]<=0&&go()),e[t].isOffScreen()&&e.splice(t,1)}for(let t=b.length-1;t>=0;t--)for(let n=e.length-1;n>=0;n--){const o=b[t],a=e[n];if(o.x>a.x&&o.x<a.x+a.w&&o.y>a.y&&o.y<a.y+a.h){if(a.hit()){e.splice(n,1),ed++;let o=0;'k'===a.type?o=100*w:'s'===a.type?o=50*w:o=30*w;cc++,ct=60,p.sc+=o,cc>=10?(p.sc*=3,sc(),snd.cb.play()):cc>=5&&(p.sc*=2,sc()),Math.random()<.2+.02*w&&(Math.random()<.6?pw.push(new P(a.x+a.w/2,a.y+a.h/2)):pw.push(new SP(a.x+a.w/2,a.y+a.h/2,['a','b','j'][Math.floor(3*Math.random())]))),snd.ex.play()}b.splice(t,1);break}}for(let t=pw.length-1;t>=0;t--){pw[t].update();if(pw[t].x+p.w>p.x&&pw[t].x<p.x+p.w&&pw[t].y+p.h>p.y&&pw[t].y<p.y+p.h){pw[t]instanceof SP?(p.d[pw[t].t]++,p.as[pw[t].t]=!0,ud()):(p.p[pw[t].t]=!0,pt[pw[t].t]=pd),pw.splice(t,1),snd.pu.play(),up();continue}pw[t].isOffScreen()&&pw.splice(t,1)}upt(),ba&&(boss.x+=boss.s*(sma?.5:1),(boss.x<=0||boss.x+boss.w>=W)&&(boss.s*=-1))}for(const e of b)e.draw();for(const e of e)e.draw();for(const e of eb)x.fillStyle='red',x.beginPath(),x.arc(Math.round(e.x),Math.round(e.y),Math.round(e.w/2),0,2*Math.PI),x.fill();for(const e of pw)e.draw();ba&&db(),dp(),requestAnimationFrame(gl)}window.onload=function(){ig(),r()};</script></body></html>
